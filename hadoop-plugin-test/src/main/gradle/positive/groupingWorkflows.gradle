buildscript {
  dependencies {
    classpath files("${project.pluginTestDir}/hadoop-plugin-${project.version}.jar", "${project.pluginTestDir}/hadoop-plugin-${project.version}-SNAPSHOT.jar")
  }
}

apply plugin: com.linkedin.gradle.hadoop.HadoopPlugin

// test grouping subflow jobs
hadoop {
  buildPath "jobs"
  cleanPath false

  workflow('groupingFlow') {
    // job1 is not defined yet

    groupJobs true

    targets 'job1', 'groupingSubFlow'

    noOpJob('job1') {
      depends 'job2'
    }

    workflow('groupingSubFlow') {
      groupJobs true

      noOpJob('sub-job1') {
      }

      flowDepends 'job1'
      targets 'sub-job1'
    }

    noOpJob('job2') {
    }
  }

  workflow('nonGroupingFlow') {
    targets 'job1', 'groupingSubFlow2'

    noOpJob('job1') {
      depends 'job2'
    }

    workflow('groupingSubFlow2') {
      groupJobs true

      noOpJob('sub-job1') {
      }

      flowDepends 'job1'
      targets 'sub-job1'
    }

    noOpJob('job2') {
    }
  }
}